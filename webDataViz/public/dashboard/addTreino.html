<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/addTreino.css">
    <link rel="stylesheet" href="../css/nav.css">
    <title>Document</title>
</head>

<body onload="listarTreinos(), carregarTreinosSelect(treinos)">

    <div class="header">
        <div class="container">
            <div class="logoTitulo">
                <img src="../assets/icon/LogoFocus.svg" width="90vw" alt="">
            </div>

            <nav class="navbar">
                <div class="links">
                    <div>
                        <a href="./addSerie.html">Home</a>
                    </div>
                    <div style="background-color: #a90820;">
                        <a>Ficha</a>
                    </div>
                    <div>
                        <a href="./login1.html">Dashboard</a>
                    </div>
                    <div>
                        <a href="./historicoFicha.html">Historico</a>
                    </div>
                </div>
            </nav>

        </div>
    </div>

    <main>

        <section class="content">

            <!-- FORMUL√ÅRIO FICHA -->
            <div id="secCadastrarTreino">
                <div class="titulo">
                    <p class="secTitulo">Cadastre informa√ß√µes da sua Ficha</p>
                    <p style="color:#fff; margin-left: 5%;">Em caso de recarregar a pagina sua ficha n√£o ser√° perdida!
                        Apenas prossiga no cadastro
                    </p>
                </div>

                <div class="form">

                    <div class="campos">
                        <div class="campo">
                            <label>Titulo</label>
                            <input id="iptTitulo" type="text" placeholder="Foco em ombros">
                        </div>

                        <div class="campo">
                            <label>Data inicio</label>
                            <input id="iptDtInicio" type="date">
                        </div>
                    </div>

                    <div class="campos">
                        <div class="campo">
                            <label>Frequencia Semanal</label>
                            <input id="iptFrequencia" type="text">
                        </div>

                        <div class="campo">
                            <label>Objetivo</label>
                            <form>
                                <p>
                                    <select id="objSelect">
                                        <option value="" selected disabled>Selecione seu objetivo</option>
                                        <option value="forca">üí™üèº For√ßa</option>
                                        <option value="hipertrofia">üèãüèº‚Äç‚ôÇÔ∏è Hipertrofia</option>
                                        <option value="reabilitacao">üöë Reabilita√ß√£o</option>
                                        <option value="Emagrecimento">üèÉüèª Emagrecimento</option>
                                    </select>
                                </p>
                            </form>
                        </div>
                    </div>

                    <div class="observacao">
                        <label>Observa√ß√µes</label>
                        <textarea id="textObservacao"></textarea>
                    </div>

                    <div class="btn">
                        <button onclick="cadastrarFicha()">Cadastrar ficha</button>
                    </div>

                </div>
            </div>

            <section id="addTreino">
                <div class="contentAddTreino">
                    <div class="tituloTreino">
                        <p>Cadastrar treinos</p>
                    </div>
                    <p style="color:#fff; margin-left: 3%;">Ap√≥s cadastrar a ficha, cadastre os treinos! seprando-os por
                        agrupamento muscular</p>

                    <div class="campos camposTreino">
                        <div class="campo campoTreino">
                            <label>Titulo do treino</label>
                            <input id="iptTreinoTitulo" type="text" placeholder="Costas e biecps">
                        </div>

                        <div class="observacao">
                            <label>Observa√ß√µes</label>
                            <textarea id="observacaoTreino" class="textAreaTreino"></textarea>
                        </div>
                    </div>

                    <div class="btnTreino">
                        <button onclick="cadastrarTreino()">Cadastrar Treino</button>
                    </div>
                </div>
            </section>

            <section id="addExercicio">

                <div class="contentAddExercicio">

                    <div class="tituloExercicio">
                        <p>Adicionar Exerc√≠cio</p>
                    </div>
                    <div class="camposExercicio">

                        <div class="campoEx">
                            <label>Treino</label>
                            <select id="selectTreino"></select>
                        </div>


                        <div class="campoEx">
                            <label>Dificuldade</label>
                            <select id="iptDificuldadeEx">
                                <option value="#">Selecione sua dificuldade</option>
                                <option value="Dificil">dif√≠cil</option>
                                <option value="Media">Medio</option>
                                <option value="Facil">F√°cil</option>


                            </select>
                        </div>
                    </div>



                    <div class="camposExercicio">
                        <div class="campoEx">
                            <label>Nome</label>
                            <input id="iptNomeEx" type="text" placeholder="Supino inclinado">
                        </div>

                        <div class="campoEx">
                            <label>Descri√ß√£o</label>
                            <input id="iptDescEx" type="text" placeholder="Drop-Set / Rest-Pause ...">
                        </div>
                    </div>

                    <div class="camposExercicio">
                        <div class="campoEx">
                            <label>Agrupamento muscular</label>
                            <input id="iptGrupoEx" type="text" placeholder="Peitoral / Costas / B√≠ceps...">
                        </div>

                        <div class="campoEx">
                            <label>Equipamento</label>
                            <input id="iptEquipEx" type="text" placeholder="M√°quina / Halteres / Barra">
                        </div>
                    </div>

                    <div class="btnAddEx">
                        <button class="btnExercicio" onclick="adicionarExercicio()">Adicionar exerc√≠cio</button>
                    </div>


                    <div id="divListaExercicios">

                        <!-- <table id="listaExercicios" class="tabelaExercicio" style="width:100%">
                        <tr>
                            <th class="tituloEx">Nome</th>
                            <th class="tituloEx">Agrupamento Muscular</th>
                            <th class="tituloEx">Equipamento</th>
                        </tr>
                             <tr>
                                <td class="subInfoEx">${ex.nomeExercicio}</td>
                                <td class="subInfoEx">${ex.agrupamento}</td>
                                <td class="subInfoEx"> ${ex.equipamento}</td>
                        </tr>
                    </table>
                         -->
                    </div>

                    <div class="btnAddEx">
                        <button class="btnExercicio" onclick="adicionarExercicio()">Cadastrar lista de
                            exercicios</button>
                    </div>

            </section>

        </section>

    </main>


</body>

<script>



    const idFicha = sessionStorage.ID_FICHA;



    function cadastrarFicha() {


        var idUsuario = sessionStorage.ID_USUARIO
        var tituloVar = iptTitulo.value
        var dataInicioVar = iptDtInicio.value
        var frequenciaVar = Number(iptFrequencia.value);
        var objetivoVar = objSelect.value;
        const observacaoVar = document.getElementById('textObservacao').value;


        if (
            tituloVar == "" ||
            dataInicioVar == "" ||
            frequenciaVar == "" ||
            objetivoVar == ""
        ) {
            console.log('Preencha todos os campos')
        }

        fetch("/fichas/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                idUsuario: idUsuario,
                tituloVar: tituloVar,
                dataInicioVar: dataInicioVar,
                frequenciaVar: frequenciaVar,
                objetivoVar: objetivoVar,
                observacaoVar: observacaoVar
            }),

        }).then(resposta => resposta.json())
            .then(ficha => {
                console.log('Ronaldo:', ficha);
                sessionStorage.ID_FICHA = ficha.insertId;
                console.log(sessionStorage.ID_FICHA)

            });

        document.getElementById("objetivoVar").value = "";
        document.getElementById("iptTitulo").value = "";
        document.getElementById("dataInicioVar").value = "";
        document.getElementById("frequenciaVar").value = "";
    }

    function listarTreinos() {
        const idFicha = sessionStorage.ID_FICHA;

        fetch(`/treinos/listar/${idFicha}`)
            .then(resposta => resposta.json())
            .then(treinos => {
                sessionStorage.TREINOS = JSON.stringify(treinos);
                console.log(treinos)
                carregarTreinosSelect(treinos);
            });

    }
    function carregarTreinosSelect(treinos) {

        const select = document.getElementById("selectTreino");
        select.innerHTML = `<option disabled selected>Selecione um treino</option
    function adicionarExercicio() {



    function adicionarExercicio() {
        const idTreino = document.getElementById("selectTreino").value;
        const nomeEx = iptNomeEx.value;
        const descEx = iptDescEx.value;
        const grupoEx = iptGrupoEx.value;
        const equipEx = iptEquipEx.value;

        if (!idTreino) {
            alert("Selecione um treino!");
            return;
        }



    >`;

        treinos.forEach(treino => {
            select.innerHTML += `
            <option  value="${treino.id}">${treino.titulo}</option>
        `;
        });
    }



    function cadastrarTreino() {

        var tituloTreinoVar = iptTreinoTitulo.value;
        var observacaoTreinoVar = observacaoTreino.value;
        var idFichaVar = sessionStorage.ID_FICHA;

        fetch("/treinos/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                tituloTreinoVar: tituloTreinoVar,
                observacaoTreinoVar: observacaoTreinoVar,
                idFichaVar: idFichaVar
            }),
        }).then(resposta => resposta.json().then(treino => {
            console.log('Treino:', treino);
            listarTreinos();

            iptTreinoTitulo.value = '';
            observacaoTreino.value = '';

        }))
    }









    function adicionarExercicio() {

        // IDs CORRETOS
        var nomeEx = document.getElementById("iptNomeEx").value;
        var descricaoEx = document.getElementById("iptDescEx").value;
        var grupoEx = document.getElementById("iptGrupoEx").value;
        var equipEx = document.getElementById("iptEquipEx").value;
        var dificuldadeEx = document.getElementById("iptDificuldadeEx").value;





        if (!nomeEx || !grupoEx || !equipEx || !dificuldadeEx) {
            alert("Preencha todos os campos!");
            return;
        }

        let lista = document.getElementById("listaExercicios");

        exercicioObj.push({
            agrupamento: grupoEx,
            nomeExercicio: nomeEx,
            equipamento: equipEx,
            descricao: descricaoEx,
            dificuldade: dificuldadeEx

        });
        console.table(exercicioObj)
        document.getElementById("divListaExercicios").innerHTML = `
                   <table id="listaExercicios" class="tabelaExercicio" style="width:100%">
                        <tr>
                            <th class="tituloEx">Nome</th>
                            <th class="tituloEx">Agrupamento Muscular</th>
                            <th class="tituloEx">Equipamento</th>
                            <th class="tituloEx">Dificuldade</th>

                        </tr>
                    </table>
            `;

        exercicioObj.forEach(ex => {
            document.getElementById("listaExercicios").innerHTML += `
                        <tr>
                                <td class="subInfoEx">${ex.nomeExercicio}</td>
                                <td class="subInfoEx">${ex.agrupamento}</td>
                                <td class="subInfoEx"> ${ex.equipamento}</td>
                                <td class="subInfoEx"> ${ex.dificuldade}</td>

                        </tr>
            `;

        }),
            console.log(exercicioObj)



        // Limpar campos
        document.getElementById("iptNomeEx").value = "";
        document.getElementById("iptDescEx").value = "";
        document.getElementById("iptGrupoEx").value = "";
        document.getElementById("iptEquipEx").value = "";
    }


    var vNome = []
    var vDesc = []
    var vAgrupMusc = []
    var vEquipamento = []

    const exercicioObj = []





</script>

</html>